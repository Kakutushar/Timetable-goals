<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Dashboard</title>
    <!-- Link to the CSS file -->
    <link rel="stylesheet" href="style.css">
    <!-- Google Fonts for a clean look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Main container for the entire application -->
    <div id="app-container">
        <!-- Left column for the profile image -->
        <aside class="sidebar">
            <div class="image-uploader">
                <!-- The image will be displayed here -->
                <img src="https://placehold.co/200x200/e2e8f0/475569?text=Upload" alt="User Profile" id="profile-image" onerror="this.onerror=null;this.src='https://placehold.co/200x200/e2e8f0/475569?text=Image';">
                <!-- This is a hidden file input; the label acts as the button -->
                <input type="file" id="image-upload-input" accept="image/*" style="display: none;">
                <label for="image-upload-input" class="upload-btn">Change Image</label>
            </div>
        </aside>

        <!-- Right column for the main content -->
        <main class="main-content">
            <header>
                <!-- Main heading, which will be editable -->
                <h1 id="main-heading" contenteditable="true">My Daily Dashboard</h1>
            </header>

            <!-- Section for daily goals and streak counter -->
            <section class="goals-and-streak">
                <div class="daily-goals-card">
                    <div class="card-header">
                        <h3>Today's Goals</h3>
                        <!-- Progress bar container -->
                        <div class="progress-container">
                            <div id="progress-bar"></div>
                        </div>
                    </div>
                    <!-- List where goals will be added dynamically -->
                    <ul id="goals-list"></ul>
                    <!-- Input form to add a new goal -->
                    <div class="add-goal-form">
                        <input type="text" id="new-goal-input" placeholder="Add a new goal...">
                        <button id="add-goal-btn">+</button>
                    </div>
                </div>
                <div class="streak-card">
                    <h3>Streak</h3>
                    <div class="streak-circle">
                        <span id="streak-count">0</span>
                        <small>days</small>
                    </div>
                </div>
            </section>

            <!-- Section for the weekly timetable -->
            <section class="timetable-card">
                 <div class="card-header">
                    <h3>Weekly Timetable</h3>
                    <button id="edit-timetable-btn">Edit</button>
                </div>
                <table id="timetable">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Mon</th>
                            <th>Tue</th>
                            <th>Wed</th>
                            <th>Thu</th>
                            <th>Fri</th>
                            <th>Sat</th>
                            <th>Sun</th>
                        </tr>
                    </thead>
                    <!-- Table body will be populated by JavaScript -->
                    <tbody>
                    </tbody>
                </table>
            </section>
        </main>
    </div>

    <!-- Modal for editing timetable. It's hidden by default. -->
    <div id="timetable-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>Edit Schedule</h3>
            <p>Editing for <strong id="modal-cell-info"></strong></p>
            <textarea id="modal-textarea" rows="4" placeholder="Enter activity..."></textarea>
            <div class="modal-actions">
                <button id="modal-save-btn">Save</button>
                <button id="modal-cancel-btn">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK scripts -->
    <!-- IMPORTANT: You will need to get these from your own Firebase project -->
    <script type="module">
        // Import functions from the Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";
        import { getStorage, ref, uploadString, getDownloadURL } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-storage.js";

        // Your web app's Firebase configuration
        // REPLACE THIS WITH YOUR ACTUAL FIREBASE CONFIG
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_PROJECT_ID.appspot.com",
            messagingSenderId: "YOUR_SENDER_ID",
            appId: "YOUR_APP_ID"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        const storage = getStorage(app);

        // Export for use in our main script.js file
        window.firebaseServices = {
            auth,
            db,
            storage,
            doc,
            getDoc,
            setDoc,
            onSnapshot,
            ref,
            uploadString,
            getDownloadURL,
            signInAnonymously,
            onAuthStateChanged
        };

        // Trigger a custom event when Firebase is ready
        document.dispatchEvent(new CustomEvent('firebase-ready'));
    </script>

    <!-- Link to the main JavaScript file -->
    <script type="module" src="script.js"></script>
</body>
</html>
